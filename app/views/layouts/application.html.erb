<!DOCTYPE html>
<html>
  <head>
    <title>FinalProject</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= stylesheet_link_tag 'sb-admin-2.min.css' %>
    <%= stylesheet_link_tag 'vendor/fontawesome-free/css/all.min.css'%>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>

    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <%= stylesheet_link_tag "https://cdnjs.cloudflare.com/ajax/libs/slim-select/1.27.1/slimselect.min.css", "data-turbo-track": "reload" %>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/slim-select/1.27.1/slimselect.min.css" rel="stylesheet"/>
  </head>

  <body id="page-top">
    <% if user_signed_in? %>
      <!-- Page Wrapper -->
      <div id="wrapper">

          <!-- Sidebar -->
            <%= render "partials/sidebar" %>
          <!-- End of Sidebar -->

          <!-- Content Wrapper -->
          <div id="content-wrapper" class="d-flex flex-column">

              <!-- Main Content -->
              <div id="content">

                  <!-- Topbar -->
                  <%= render "partials/header" %>
                  <!-- End of Topbar -->

                  <!-- Begin Page Content -->
                  <div class="container-fluid">
                    <h2><%= page_header %></h2>
                    </br>
                    <div class="card shadow mb-4">
                      <div class="card-body">
                        <%= yield %>
                      </div>
                    </div>
                  </div>
                  <!-- /.container-fluid -->

              </div>
              <!-- End of Main Content -->

              <!-- Footer -->
                <%= render "partials/footer" %>
              <!-- End of Footer -->

          </div>
          <!-- End of Content Wrapper -->

      </div>
      <!-- End of Page Wrapper -->
      <%= render "partials/sign_out_modal" %>
    <% else %>
      <%= yield %>
    <% end %>
    <%= toastr_flash %>
  </body>
</html>


<script>
  var collection = document.getElementsByClassName("collapse-item");
  var searchText = "<%= page_header %>";
  // document.getElementById("nav-<%= controller.controller_name %>").classList.add("show");
  console.log(document.getElementById("nav-<%= controller.controller_name %>"))
  for(i = 0; i < collection.length; i++) {
    element = collection[i]
    if(element.textContent == searchText) {
      element.classList.add("active");
      getParentNode(element, 2).classList.add("show");
      break;
    };
  }

  function getParentNode(element, level = 1) { 
    while (level-- > 0) {
      element = element.parentNode;
      if (!element) return null;
    }
    return element;
  }
</script>